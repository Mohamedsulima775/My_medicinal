# ğŸ”— Ø¯Ù„ÙŠÙ„ Ø±Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…Ø¹ My_medicinal / Dawaii

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
1. [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©](#Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
2. [Ø¥Ø¹Ø¯Ø§Ø¯ Backend](#Ø¥Ø¹Ø¯Ø§Ø¯-backend)
3. [Ø±Ø¨Ø· ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ¨Ø§ÙŠÙ„](#Ø±Ø¨Ø·-ØªØ·Ø¨ÙŠÙ‚-Ù…ÙˆØ¨Ø§ÙŠÙ„)
4. [Ø±Ø¨Ø· ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨](#Ø±Ø¨Ø·-ØªØ·Ø¨ÙŠÙ‚-ÙˆÙŠØ¨)
5. [Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚](#Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©-ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚)
6. [Ø£Ù…Ø«Ù„Ø© Ø¹Ù…Ù„ÙŠØ©](#Ø£Ù…Ø«Ù„Ø©-Ø¹Ù…Ù„ÙŠØ©)
7. [Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡](#Ø§Ø³ØªÙƒØ´Ø§Ù-Ø§Ù„Ø£Ø®Ø·Ø§Ø¡)

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

My_medicinal ÙŠÙˆÙØ± **RESTful API** ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø·Ù‡ Ù…Ø¹ Ø£ÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø®Ø§Ø±Ø¬ÙŠ:

- âœ… **ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…ÙˆØ¨Ø§ÙŠÙ„**: iOS (Swift/SwiftUI), Android (Kotlin/Java), Flutter, React Native
- âœ… **ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆÙŠØ¨**: React, Vue.js, Angular, Next.js
- âœ… **Ø£Ù†Ø¸Ù…Ø© Ø®Ø§Ø±Ø¬ÙŠØ©**: Ø£ÙŠ Ù†Ø¸Ø§Ù… ÙŠØ¯Ø¹Ù… HTTP REST API

### Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Client Applications                      â”‚
â”‚  (Mobile: iOS/Android/Flutter | Web: React/Vue/Angular)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTPS REST API
                         â”‚ Authorization: Bearer {token}
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              My_medicinal Backend (Frappe)                  â”‚
â”‚                  Base URL: https://your-domain.com          â”‚
â”‚                  Endpoint: /api/method/...                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Authentication APIs   â€¢ Medication APIs                  â”‚
â”‚  â€¢ Patient APIs          â€¢ Consultation APIs                â”‚
â”‚  â€¢ Prescription APIs     â€¢ Order APIs                       â”‚
â”‚  â€¢ Notification APIs     â€¢ Provider APIs                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MariaDB/MySQL + Redis + Firebase               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Ø¥Ø¹Ø¯Ø§Ø¯ Backend

### 1ï¸âƒ£ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…

```bash
# Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ù…Ø¬Ù„Ø¯ Frappe Bench
cd my-bench

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…
bench start

# Ø£Ùˆ ØªØ´ØºÙŠÙ„ ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
bench start &
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
- Backend Ù…ØªØ§Ø­ Ø¹Ù„Ù‰: `http://localhost:8000`
- API Endpoint: `http://localhost:8000/api/method/{endpoint_name}`

### 2ï¸âƒ£ Ø¥Ø¹Ø¯Ø§Ø¯ CORS (Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©)

Ø§ÙØªØ­ Ù…Ù„Ù Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:

```bash
# ÙØªØ­ Ù…Ù„Ù site_config.json
nano sites/my_medicinal.local/site_config.json
```

Ø£Ø¶Ù Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª CORS:

```json
{
  "db_name": "...",
  "db_password": "...",
  "allow_cors": "*",
  "cors_allowed_origins": [
    "http://localhost:3000",
    "http://localhost:8080",
    "http://192.168.1.100:3000",
    "https://your-mobile-app.com"
  ],
  "cors_allowed_methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
  "cors_allowed_headers": ["Content-Type", "Authorization"]
}
```

**âš ï¸ Ù„Ù„Ø¥Ù†ØªØ§Ø¬:** Ø§Ø³ØªØ¨Ø¯Ù„ `"*"` Ø¨Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ù„ØªØ·Ø¨ÙŠÙ‚Ùƒ.

### 3ï¸âƒ£ ØªÙØ¹ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase (Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©)

```bash
# Ù†Ø³Ø® Ù…Ù„Ù Firebase Credentials
cp firebase_credentials.json sites/my_medicinal.local/

# Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦ÙŠØ©
nano .env
```

ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯:

```env
FCM_ENABLED=1
FCM_CREDENTIALS_PATH=./firebase_credentials.json
```

### 4ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„

```bash
# Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„API
curl http://localhost:8000/api/method/my_medicinal.api.patient.login \
  -H "Content-Type: application/json" \
  -d '{"mobile":"0512345678","password":"test123"}'
```

Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†ØªÙŠØ¬Ø© JSONØŒ ÙØ§Ù„Ø®Ø§Ø¯Ù… ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­! âœ…

---

## ğŸ“± Ø±Ø¨Ø· ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ¨Ø§ÙŠÙ„

### A. Flutter (Ù…Ø«Ø§Ù„)

#### 1. Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

```yaml
# pubspec.yaml
dependencies:
  http: ^1.1.0
  shared_preferences: ^2.2.2
  firebase_messaging: ^14.7.9
```

#### 2. Ø¥Ù†Ø´Ø§Ø¡ API Service

```dart
// lib/services/api_service.dart
import 'package:http/http.dart' as http;
import 'dart:convert';
import 'package:shared_preferences/shared_preferences.dart';

class ApiService {
  // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
  static const String baseUrl = 'http://192.168.1.100:8000';
  static const String apiPath = '/api/method';

  String? _authToken;

  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Token Ø§Ù„Ù…Ø­ÙÙˆØ¸
  Future<String?> getAuthToken() async {
    final prefs = await SharedPreferences.getInstance();
    _authToken = prefs.getString('auth_token');
    return _authToken;
  }

  // Ø­ÙØ¸ Token Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  Future<void> saveAuthToken(String token) async {
    final prefs = await SharedPreferences.getInstance();
    await prefs.setString('auth_token', token);
    _authToken = token;
  }

  // Ø±Ø¤ÙˆØ³ HTTP Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  Future<Map<String, String>> _getHeaders() async {
    await getAuthToken();
    return {
      'Content-Type': 'application/json',
      if (_authToken != null) 'Authorization': 'Bearer $_authToken',
    };
  }

  // 1. ØªØ³Ø¬ÙŠÙ„ Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯
  Future<Map<String, dynamic>> register({
    required String patientName,
    required String mobile,
    required String email,
    required String password,
    String? dateOfBirth,
    String? gender,
  }) async {
    final url = Uri.parse('$baseUrl$apiPath/my_medicinal.api.patient.register');

    final response = await http.post(
      url,
      headers: await _getHeaders(),
      body: jsonEncode({
        'patient_name': patientName,
        'mobile': mobile,
        'email': email,
        'password': password,
        'date_of_birth': dateOfBirth,
        'gender': gender,
      }),
    );

    if (response.statusCode == 200) {
      final data = jsonDecode(response.body);
      final authToken = data['message']['auth_token'];
      await saveAuthToken(authToken);
      return data['message'];
    } else {
      throw Exception('ÙØ´Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${response.body}');
    }
  }

  // 2. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  Future<Map<String, dynamic>> login(String mobile, String password) async {
    final url = Uri.parse('$baseUrl$apiPath/my_medicinal.api.patient.login');

    final response = await http.post(
      url,
      headers: {'Content-Type': 'application/json'},
      body: jsonEncode({
        'mobile': mobile,
        'password': password,
      }),
    );

    if (response.statusCode == 200) {
      final data = jsonDecode(response.body);
      final authToken = data['message']['auth_token'];
      await saveAuthToken(authToken);
      return data['message'];
    } else {
      throw Exception('ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ${response.body}');
    }
  }

  // 3. Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
  Future<Map<String, dynamic>> getProfile(String patientId) async {
    final url = Uri.parse(
      '$baseUrl$apiPath/my_medicinal.api.patient.get_profile?patient_id=$patientId'
    );

    final response = await http.get(url, headers: await _getHeaders());

    if (response.statusCode == 200) {
      final data = jsonDecode(response.body);
      return data['message'];
    } else {
      throw Exception('ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${response.body}');
    }
  }

  // 4. Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©
  Future<List<dynamic>> getMedications(String patientId) async {
    final url = Uri.parse(
      '$baseUrl$apiPath/my_medicinal.api.medication_schedule.get_medications?patient_id=$patientId'
    );

    final response = await http.get(url, headers: await _getHeaders());

    if (response.statusCode == 200) {
      final data = jsonDecode(response.body);
      return data['message'];
    } else {
      throw Exception('ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©: ${response.body}');
    }
  }

  // 5. ØªØ³Ø¬ÙŠÙ„ Ø£Ø®Ø° Ø§Ù„Ø¯ÙˆØ§Ø¡
  Future<Map<String, dynamic>> logMedication({
    required String patientId,
    required String scheduleId,
    required String status, // "Taken", "Missed", "Skipped"
    String? notes,
  }) async {
    final url = Uri.parse(
      '$baseUrl$apiPath/my_medicinal.api.medication_schedule.log_medication_taken'
    );

    final response = await http.post(
      url,
      headers: await _getHeaders(),
      body: jsonEncode({
        'patient_id': patientId,
        'schedule_id': scheduleId,
        'status': status,
        'notes': notes,
      }),
    );

    if (response.statusCode == 200) {
      final data = jsonDecode(response.body);
      return data['message'];
    } else {
      throw Exception('ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ§Ø¡: ${response.body}');
    }
  }

  // 6. ØªØ³Ø¬ÙŠÙ„ FCM Token Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
  Future<bool> registerDevice(String fcmToken) async {
    final url = Uri.parse(
      '$baseUrl$apiPath/my_medicinal.my_medicinal.notifications.register_device'
    );

    final response = await http.post(
      url,
      headers: await _getHeaders(),
      body: jsonEncode({
        'fcm_token': fcmToken,
        'device_type': 'mobile',
      }),
    );

    return response.statusCode == 200;
  }
}
```

#### 3. Ø§Ø³ØªØ®Ø¯Ø§Ù… API ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚

```dart
// lib/screens/login_screen.dart
import 'package:flutter/material.dart';
import '../services/api_service.dart';

class LoginScreen extends StatefulWidget {
  @override
  _LoginScreenState createState() => _LoginScreenState();
}

class _LoginScreenState extends State<LoginScreen> {
  final _mobileController = TextEditingController();
  final _passwordController = TextEditingController();
  final _apiService = ApiService();
  bool _isLoading = false;

  Future<void> _login() async {
    setState(() => _isLoading = true);

    try {
      final result = await _apiService.login(
        _mobileController.text,
        _passwordController.text,
      );

      // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      Navigator.pushReplacementNamed(context, '/home');

      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text(result['message'] ?? 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„')),
      );
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('Ø®Ø·Ø£: $e')),
      );
    } finally {
      setState(() => _isLoading = false);
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„')),
      body: Padding(
        padding: EdgeInsets.all(16.0),
        child: Column(
          children: [
            TextField(
              controller: _mobileController,
              decoration: InputDecoration(labelText: 'Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„'),
              keyboardType: TextInputType.phone,
            ),
            TextField(
              controller: _passwordController,
              decoration: InputDecoration(labelText: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±'),
              obscureText: true,
            ),
            SizedBox(height: 20),
            _isLoading
                ? CircularProgressIndicator()
                : ElevatedButton(
                    onPressed: _login,
                    child: Text('Ø¯Ø®ÙˆÙ„'),
                  ),
          ],
        ),
      ),
    );
  }
}
```

---

### B. React Native (Ù…Ø«Ø§Ù„)

#### 1. Ø¥Ù†Ø´Ø§Ø¡ API Service

```javascript
// services/api.js
import AsyncStorage from '@react-native-async-storage/async-storage';

const BASE_URL = 'http://192.168.1.100:8000';
const API_PATH = '/api/method';

class ApiService {
  constructor() {
    this.authToken = null;
  }

  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Token
  async getAuthToken() {
    if (!this.authToken) {
      this.authToken = await AsyncStorage.getItem('auth_token');
    }
    return this.authToken;
  }

  // Ø­ÙØ¸ Token
  async saveAuthToken(token) {
    this.authToken = token;
    await AsyncStorage.setItem('auth_token', token);
  }

  // Ø±Ø¤ÙˆØ³ HTTP
  async getHeaders() {
    await this.getAuthToken();
    return {
      'Content-Type': 'application/json',
      ...(this.authToken && { 'Authorization': `Bearer ${this.authToken}` }),
    };
  }

  // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  async login(mobile, password) {
    const response = await fetch(`${BASE_URL}${API_PATH}/my_medicinal.api.patient.login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ mobile, password }),
    });

    const data = await response.json();

    if (response.ok) {
      await this.saveAuthToken(data.message.auth_token);
      return data.message;
    } else {
      throw new Error(data.message || 'ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
    }
  }

  // Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©
  async getMedications(patientId) {
    const response = await fetch(
      `${BASE_URL}${API_PATH}/my_medicinal.api.medication_schedule.get_medications?patient_id=${patientId}`,
      {
        method: 'GET',
        headers: await this.getHeaders(),
      }
    );

    const data = await response.json();

    if (response.ok) {
      return data.message;
    } else {
      throw new Error('ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©');
    }
  }
}

export default new ApiService();
```

#### 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Component

```javascript
// screens/LoginScreen.js
import React, { useState } from 'react';
import { View, TextInput, Button, Alert } from 'react-native';
import ApiService from '../services/api';

export default function LoginScreen({ navigation }) {
  const [mobile, setMobile] = useState('');
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);

  const handleLogin = async () => {
    setLoading(true);
    try {
      const result = await ApiService.login(mobile, password);
      Alert.alert('Ù†Ø¬Ø­', result.message);
      navigation.replace('Home');
    } catch (error) {
      Alert.alert('Ø®Ø·Ø£', error.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <View style={{ padding: 20 }}>
      <TextInput
        placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„"
        value={mobile}
        onChangeText={setMobile}
        keyboardType="phone-pad"
      />
      <TextInput
        placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
        value={password}
        onChangeText={setPassword}
        secureTextEntry
      />
      <Button
        title={loading ? "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..." : "Ø¯Ø®ÙˆÙ„"}
        onPress={handleLogin}
        disabled={loading}
      />
    </View>
  );
}
```

---

## ğŸŒ Ø±Ø¨Ø· ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨

### React.js (Ù…Ø«Ø§Ù„)

#### 1. Ø¥Ù†Ø´Ø§Ø¡ API Service

```javascript
// src/services/api.js
const BASE_URL = 'http://localhost:8000';
const API_PATH = '/api/method';

class ApiService {
  constructor() {
    this.authToken = localStorage.getItem('auth_token');
  }

  setAuthToken(token) {
    this.authToken = token;
    localStorage.setItem('auth_token', token);
  }

  getHeaders() {
    return {
      'Content-Type': 'application/json',
      ...(this.authToken && { 'Authorization': `Bearer ${this.authToken}` }),
    };
  }

  async login(mobile, password) {
    const response = await fetch(`${BASE_URL}${API_PATH}/my_medicinal.api.patient.login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ mobile, password }),
    });

    const data = await response.json();

    if (response.ok) {
      this.setAuthToken(data.message.auth_token);
      return data.message;
    } else {
      throw new Error(data.message || 'ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
    }
  }

  async getProfile(patientId) {
    const response = await fetch(
      `${BASE_URL}${API_PATH}/my_medicinal.api.patient.get_profile?patient_id=${patientId}`,
      {
        method: 'GET',
        headers: this.getHeaders(),
      }
    );

    const data = await response.json();

    if (response.ok) {
      return data.message;
    } else {
      throw new Error('ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ');
    }
  }

  async getMedications(patientId) {
    const response = await fetch(
      `${BASE_URL}${API_PATH}/my_medicinal.api.medication_schedule.get_medications?patient_id=${patientId}`,
      {
        method: 'GET',
        headers: this.getHeaders(),
      }
    );

    const data = await response.json();

    if (response.ok) {
      return data.message;
    } else {
      throw new Error('ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©');
    }
  }
}

export default new ApiService();
```

#### 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Component

```jsx
// src/components/Login.jsx
import React, { useState } from 'react';
import ApiService from '../services/api';
import { useNavigate } from 'react-router-dom';

export default function Login() {
  const [mobile, setMobile] = useState('');
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      const result = await ApiService.login(mobile, password);
      console.log('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', result);
      navigate('/dashboard');
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="login-container">
      <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
      <form onSubmit={handleSubmit}>
        <input
          type="tel"
          placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„"
          value={mobile}
          onChange={(e) => setMobile(e.target.value)}
          required
        />
        <input
          type="password"
          placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
          value={password}
          onChange={(e) => setPassword(e.target.value)}
          required
        />
        {error && <p style={{color: 'red'}}>{error}</p>}
        <button type="submit" disabled={loading}>
          {loading ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...' : 'Ø¯Ø®ÙˆÙ„'}
        </button>
      </form>
    </div>
  );
}
```

---

## ğŸ” Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚

### Ø¢Ù„ÙŠØ© Token-Based Authentication

```
1. Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ³Ø¬Ù„ Ø¯Ø®ÙˆÙ„
   â†“
2. Backend ÙŠØ±Ø¬Ø¹ auth_token (32+ Ø­Ø±Ù)
   â†“
3. Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ­ÙØ¸ Token (LocalStorage/AsyncStorage/SharedPreferences)
   â†“
4. ÙƒÙ„ Ø·Ù„Ø¨ Ù„Ø§Ø­Ù‚ ÙŠØ±Ø³Ù„ Token ÙÙŠ Header
   Authorization: Bearer {auth_token}
   â†“
5. Backend ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Token ÙˆÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„
```

### Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Header Ø§Ù„ÙƒØ§Ù…Ù„

```http
POST /api/method/my_medicinal.api.medication_schedule.add_medication HTTP/1.1
Host: your-domain.com
Content-Type: application/json
Authorization: Bearer a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6
```

### Ø¥Ø¯Ø§Ø±Ø© Token Expiry

```javascript
// Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Token Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
async function refreshToken() {
  const response = await fetch(`${BASE_URL}/api/method/my_medicinal.api.patient.refresh_token`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${oldToken}`,
    },
  });

  const data = await response.json();

  if (response.ok) {
    // Ø­ÙØ¸ Token Ø§Ù„Ø¬Ø¯ÙŠØ¯
    localStorage.setItem('auth_token', data.message.new_token);
    return data.message.new_token;
  } else {
    // ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ù„Ù„Ø¯Ø®ÙˆÙ„
    window.location.href = '/login';
  }
}

// Interceptor Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ 401 Unauthorized
fetch(url, options)
  .then(response => {
    if (response.status === 401) {
      // Token Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
      return refreshToken().then(newToken => {
        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø§Ù„Token Ø§Ù„Ø¬Ø¯ÙŠØ¯
        options.headers.Authorization = `Bearer ${newToken}`;
        return fetch(url, options);
      });
    }
    return response;
  });
```

---

## ğŸ“š Ø£Ù…Ø«Ù„Ø© Ø¹Ù…Ù„ÙŠØ©

### Ù…Ø«Ø§Ù„ 1: ØªØ·Ø¨ÙŠÙ‚ ÙƒØ§Ù…Ù„ Ù„Ù„Ø£Ø¯ÙˆÙŠØ©

```javascript
// Medication Dashboard Component
import React, { useState, useEffect } from 'react';
import ApiService from '../services/api';

export default function MedicationDashboard({ patientId }) {
  const [medications, setMedications] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadMedications();
  }, []);

  const loadMedications = async () => {
    try {
      const data = await ApiService.getMedications(patientId);
      setMedications(data);
    } catch (error) {
      console.error('Ø®Ø·Ø£:', error);
    } finally {
      setLoading(false);
    }
  };

  const takeMedication = async (scheduleId) => {
    try {
      await ApiService.logMedication({
        patient_id: patientId,
        schedule_id: scheduleId,
        status: 'Taken',
      });
      alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ ØªÙ†Ø§ÙˆÙ„ Ø§Ù„Ø¯ÙˆØ§Ø¡');
      loadMedications(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    } catch (error) {
      alert('Ø®Ø·Ø£: ' + error.message);
    }
  };

  if (loading) return <div>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>;

  return (
    <div className="medication-dashboard">
      <h2>Ø£Ø¯ÙˆÙŠØªÙŠ</h2>
      {medications.map(med => (
        <div key={med.name} className="medication-card">
          <h3>{med.medication_name}</h3>
          <p>Ø§Ù„Ø¬Ø±Ø¹Ø©: {med.dosage}</p>
          <p>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: {med.current_stock} {med.stock_unit}</p>
          <p>Ø£ÙŠØ§Ù… Ø­ØªÙ‰ Ø§Ù„Ù†ÙØ§Ø¯: {med.days_until_depletion}</p>

          <div className="times">
            {med.times.map((time, idx) => (
              <div key={idx}>
                <span>{time.time}</span>
                <span>{time.before_after_meal}</span>
              </div>
            ))}
          </div>

          <button onClick={() => takeMedication(med.name)}>
            âœ“ ØªÙ… ØªÙ†Ø§ÙˆÙ„ Ø§Ù„Ø¯ÙˆØ§Ø¡
          </button>
        </div>
      ))}
    </div>
  );
}
```

### Ù…Ø«Ø§Ù„ 2: Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (Firebase)

```javascript
// Firebase Setup (React)
import { initializeApp } from 'firebase/app';
import { getMessaging, getToken, onMessage } from 'firebase/messaging';
import ApiService from './api';

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const messaging = getMessaging(app);

// Ø·Ù„Ø¨ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØªØ³Ø¬ÙŠÙ„ Token
export async function requestNotificationPermission() {
  try {
    const permission = await Notification.requestPermission();

    if (permission === 'granted') {
      const token = await getToken(messaging, {
        vapidKey: 'YOUR_VAPID_KEY'
      });

      console.log('FCM Token:', token);

      // ØªØ³Ø¬ÙŠÙ„ Token ÙÙŠ Backend
      await ApiService.registerDevice(token);

      return token;
    } else {
      console.log('ØªÙ… Ø±ÙØ¶ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª');
    }
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª:', error);
  }
}

// Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø©
export function listenForMessages(callback) {
  onMessage(messaging, (payload) => {
    console.log('Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§Ø±Ø¯:', payload);

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
    if (callback) callback(payload);

    // Ø£Ùˆ Ø¹Ø±Ø¶ notification
    new Notification(payload.notification.title, {
      body: payload.notification.body,
      icon: '/icon.png'
    });
  });
}
```

---

## ğŸ”§ Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø© 1: CORS Error

**Ø§Ù„Ø®Ø·Ø£:**
```
Access to fetch at 'http://localhost:8000/api/method/...' from origin 'http://localhost:3000'
has been blocked by CORS policy
```

**Ø§Ù„Ø­Ù„:**
```bash
# Ø§ÙØªØ­ site_config.json
nano sites/my_medicinal.local/site_config.json

# Ø£Ø¶Ù:
{
  "allow_cors": "*",
  "cors_allowed_origins": ["http://localhost:3000"]
}

# Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…
bench restart
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø© 2: 401 Unauthorized

**Ø§Ù„Ø³Ø¨Ø¨:** Token Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø£Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯

**Ø§Ù„Ø­Ù„:**
```javascript
// ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Token
const token = localStorage.getItem('auth_token');
if (!token) {
  // Ø£Ø¹Ø¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  window.location.href = '/login';
}

// Ø£Ùˆ Ø¬Ø¯Ø¯ Token
await refreshToken();
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø© 3: Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ø§ ÙŠØ³ØªØ¬ÙŠØ¨

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**
```bash
# 1. ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…
bench start

# 2. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù†ÙØ°
netstat -tulpn | grep 8000

# 3. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„Ø§Øª
tail -f sites/my_medicinal.local/logs/web.log
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø© 4: Firebase Notifications Ù„Ø§ ØªØ¹Ù…Ù„

**Ø§Ù„Ø­Ù„:**
```bash
# 1. ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù„Ù Credentials
ls -la sites/my_medicinal.local/firebase_credentials.json

# 2. ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ù„Ù
chmod 600 firebase_credentials.json

# 3. ÙØ¹Ù‘Ù„ FCM ÙÙŠ .env
FCM_ENABLED=1
```

---

## ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

### Ù„Ù„ØªØ·ÙˆÙŠØ± (Development)
- Ø§Ø³ØªØ®Ø¯Ù… `http://localhost:8000` Ø£Ùˆ `http://192.168.1.X:8000` (IP Ø§Ù„Ø¬Ù‡Ø§Ø²)
- ÙØ¹Ù‘Ù„ CORS Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµØ§Ø¯Ø±: `"allow_cors": "*"`
- Ø§Ø³ØªØ®Ø¯Ù… `console.log` Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Responses

### Ù„Ù„Ø¥Ù†ØªØ§Ø¬ (Production)
- âœ… Ø§Ø³ØªØ®Ø¯Ù… HTTPS (`https://your-domain.com`)
- âœ… Ø­Ø¯Ø¯ CORS Domains Ø¨Ø´ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚
- âœ… ÙØ¹Ù‘Ù„ Rate Limiting
- âœ… Ø§Ø³ØªØ®Ø¯Ù… Environment Variables Ù„Ù„ API URLs
- âœ… ÙØ¹Ù‘Ù„ API Logging
- âœ… Ø£Ø¶Ù Error Tracking (Sentry)

### Ø£Ù…Ø§Ù† Ø¥Ø¶Ø§ÙÙŠ
```javascript
// ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸
const encryptToken = (token) => {
  // Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙƒØªØ¨Ø© Ù…Ø«Ù„ crypto-js
  return CryptoJS.AES.encrypt(token, 'secret-key').toString();
};

const decryptToken = (encryptedToken) => {
  const bytes = CryptoJS.AES.decrypt(encryptedToken, 'secret-key');
  return bytes.toString(CryptoJS.enc.Utf8);
};
```

---

## ğŸ“ Ø§Ù„Ø¯Ø¹Ù…

Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„:
1. Ø±Ø§Ø¬Ø¹ [API Documentation](./API_Documentation.md)
2. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø¬Ù„Ø§Øª: `tail -f sites/my_medicinal.local/logs/web.log`
3. Ø§Ø®ØªØ¨Ø± Endpoints Ø¹Ø¨Ø± Postman Ø£Ùˆ cURL
4. ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø±: mohamedsuliman923@gmail.com

---

âœ… **Ø§Ù„Ø¢Ù† ØªØ·Ø¨ÙŠÙ‚Ùƒ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¨Ø· Ù…Ø¹ My_medicinal Backend!**
